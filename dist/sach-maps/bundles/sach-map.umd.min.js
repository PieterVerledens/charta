!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("sach-map",["exports","@angular/core","@angular/common","@angular/common/http"],t):t(e["sach-map"]={},e.ng.core,e.ng.common,e.ng.common.http)}(this,function(e,t,r,n){"use strict";var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(n,o){var a,i,s,e,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function r(e){if(a)throw new TypeError("Generator is already executing.");for(;u;)try{if(a=1,i&&(s=2&e[0]?i["return"]:e[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=o.call(n,u)}catch(t){e=[6,t],i=0}finally{a=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}var i=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule]}]}],e}(),s=function(){function e(e){this.http=e}return Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),e.prototype.init=function(e,t,r,n){this._key=n,this._map=new google.maps.Map(e.nativeElement,t),r&&this.addCompass();var o=new google.maps.OverlayView;return o.draw=function(){this.getPanes().markerLayer.id="markerLayer"},o.setMap(this.map),this.map},e.prototype.getGeocodeFromAddress=function(e){return this.http.get("https://maps.googleapis.com/maps/api/geocode/json?address="+e+"&key="+this.key)},e.prototype.getAddressFromGeocode=function(a){return function e(t,i,s,u){return new(s||(s=Promise))(function(e,r){function n(e){try{a(u.next(e))}catch(t){r(t)}}function o(e){try{a(u["throw"](e))}catch(t){r(t)}}function a(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,o)}a((u=u.apply(t,i||[])).next())})}(this,void 0,void 0,function(){return o(this,function(e){return[2,new Promise(function(r,e){var n,t=new google.maps.Geocoder,o=a;t.geocode({location:o},function(e,t){t===google.maps.GeocoderStatus.OK&&(n=e[0],r(n.formatted_address))})})]})})},e.prototype.addCompass=function(){var e=document.createElement("div");e.innerHTML='<img src="https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png"> '+name,this.map.controls[google.maps.ControlPosition.RIGHT_TOP].push(e)},e.decorators=[{type:t.Injectable,args:[{providedIn:i}]}],e.ctorParameters=function(){return[{type:n.HttpClient}]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e(t.inject(n.HttpClient))},token:e,providedIn:i}),e}(),u=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule]}]}],e}(),c={CREATION:0,EDIT:1,IDLE:2};c[c.CREATION]="CREATION",c[c.EDIT]="EDIT",c[c.IDLE]="IDLE";var p=function(n){function e(t,e){var r=n.call(this,e)||this;return r.state=c.IDLE,r.rotate=0,r.addListener("click",function(e){t.setSelectedMarker(r)}),r}return function o(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(e,n),e}(google.maps.Marker),l=function(){function e(){this._markers=[]}return Object.defineProperty(e.prototype,"markers",{get:function(){return this._markers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"markerCluster",{get:function(){return this._markerCluster},enumerable:!0,configurable:!0}),e.prototype.createCluster=function(e){this._markerCluster=new MarkerClusterer(e,this.markers),this.markerCluster.setMaxZoom(16)},e.prototype.registerMarkerOnClick=function(t){var r=this,n=new p(this,{position:new google.maps.LatLng(-1,-1),map:t,draggable:!0,clickable:!0});return google.maps.event.addListener(t,"click",function(e){n.setPosition(e.latLng),r.markerCluster.addMarker(n),r.addMarker(n),t.panTo(r.getLast().getPosition())}),n},e.prototype.getGeocodeFromSelectedMarker=function(){return this.selectedMarker.getPosition()},e.prototype.findByIndex=function(e){return this._markers[e]?this._markers[e]:null},e.prototype.getLast=function(){return this._markers[this._markers.length-1]},e.prototype.countMarkers=function(){return this._markers.length},e.prototype.setSelectedMarker=function(t){this.selectedMarker=this._markers.find(function(e){return e===t})},Object.defineProperty(e.prototype,"getMarkerInCreationState",{get:function(){return this._markers.find(function(e){return e.state===c.CREATION})},enumerable:!0,configurable:!0}),e.prototype.addMarker=function(e){e.state=c.CREATION,this._markers.push(e),this.selectedMarker=e},e.prototype.rotateMarker=function(e){var t=this,r=this._markers.findIndex(function(e){return e===t.selectedMarker}),n=document.querySelectorAll("#markerLayer img")[r];n.style.transform=(e?this._markers[r].rotate+=7:this._markers[r].rotate-=7,"rotate("+this._markers[r].rotate+"deg)")},e.prototype.deleteMarker=function(){var e=this._markers[this._markers.length-1];e.state===c.CREATION&&(e.setMap(null),this._markers=this._markers.slice(0,this.countMarkers()-1),this.selectedMarker=null)},e.prototype.hideMarker=function(e){e.setMap(null)},e.prototype.saveMarker=function(){this.getLast().state=c.IDLE,this.selectedMarker=null},e.decorators=[{type:t.Injectable,args:[{providedIn:u}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e},token:e,providedIn:u}),e}();e.MapService=s,e.MapModule=i,e.MarkerService=l,e.MarkerModule=u,e.Marker=p,e.MarkerStateEnum=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sach-map.umd.min.js.map